<div class="p-4">
  <p-card header="Tu carrito de compras" class="shadow-3">
    <p *ngIf="items.length === 0" class="text-center text-color-secondary">
      No tienes productos en el carrito
    </p>

    <p-table *ngIf="items.length > 0" [value]="items" responsiveLayout="scroll">
      <ng-template pTemplate="header">
        <tr>
          <th>Producto</th>
          <th>Precio</th>
          <th>Cantidad</th>
          <th>Subtotal</th>
          <th></th>
        </tr>
      </ng-template>

      <ng-template pTemplate="body" let-item>
        <tr>
          <td class="flex align-items-center gap-2">
            <img [src]="item.imageUrl" alt="img" width="50" />
            {{ item.name }}
          </td>
          <td>{{ item.unitPrice | currency }}</td>
          <td>{{ item.quantity }}</td>
          <td>{{ item.unitPrice * item.quantity! | currency }}</td>
          <td>
            <button
              pButton
              icon="pi pi-trash"
              class="p-button-rounded p-button-danger"
              (click)="removeItem(item.productId!)"
            ></button>
          </td>
        </tr>
      </ng-template>

      <ng-template pTemplate="footer">
        <tr>
          <td colspan="3" class="text-right font-bold">Total:</td>
          <td colspan="2" class="font-bold">{{ cartInfo.total | currency }}</td>
        </tr>
      </ng-template>
    </p-table>

    <div
      class="flex justify-content-end align-items-center gap-3 mt-3"
      *ngIf="items.length > 0"
    >
      <ng-container *ngIf="address && address.street">
        <p>
          <b>Dirección:</b> {{ address.street }}, {{ address.city }},
          {{ address.state }}
        </p>
      </ng-container>

      <ng-container *ngIf="!address || !address.street">
        <p style="color: var(--red-500); font-weight: bold">
           Ve a tu perfil y agrega tu dirección para poder continuar.
        </p>
      </ng-container>

      <button
      [disabled]="!address.street"
        pButton
        label="checkout"
        class="p-button-warning"
        (click)="checkout()"
      ></button>
      <button
        pButton
        [disabled]="!address.street"
        label="Crear orden"
        icon="pi pi-credit-card"
        class="p-button-success"
        (click)="createOrder()"
      ></button>
    </div>
  </p-card>
</div>
<p-toast />
